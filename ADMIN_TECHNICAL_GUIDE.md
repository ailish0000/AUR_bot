# üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–æ—Ç–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–±–æ—Ç–∞)
2. [–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-—Å–æ–æ–±—â–µ–Ω–∏–π)
3. [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–±–∞–∑–æ–π-–∑–Ω–∞–Ω–∏–π)
4. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ NLP –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-nlp)
5. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
6. [–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–æ—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

```
AUR_bot/
‚îú‚îÄ‚îÄ bot.py                    # ü§ñ –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞ (Telegram –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
‚îú‚îÄ‚îÄ nlp_processor.py          # üß† NLP –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–Ω–∞–º–µ—Ä–µ–Ω–∏—è, —Å—É—â–Ω–æ—Å—Ç–∏, —Å–∏–Ω–æ–Ω–∏–º—ã)
‚îú‚îÄ‚îÄ enhanced_vector_db.py     # üóÉÔ∏è –í–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å —á–∞–Ω–∫–∞–º–∏
‚îú‚îÄ‚îÄ enhanced_llm.py          # ü§ñ –£–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ LLM
‚îú‚îÄ‚îÄ knowledge_base.json       # üìö –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –æ –ø—Ä–æ–¥—É–∫—Ç–∞—Ö
‚îú‚îÄ‚îÄ database.py              # üíæ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îú‚îÄ‚îÄ .env                     # üîê –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îî‚îÄ‚îÄ requirements.txt         # üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

#### 1. **Telegram Bot (bot.py)**
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã –∏ callback'–∏
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω—É

#### 2. **NLP Processor (nlp_processor.py)**
- **Intent Classifier**: —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **Entity Recognizer**: –Ω–∞—Ö–æ–¥–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ
- **Sentiment Analyzer**: –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –æ–∫—Ä–∞—Å–∫—É
- **Synonym Manager**: —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Å–∏–Ω–æ–Ω–∏–º–∞–º–∏

#### 3. **Enhanced Vector DB (enhanced_vector_db.py)**
- –†–∞–∑–±–∏–≤–∞–µ—Ç –ø—Ä–æ–¥—É–∫—Ç—ã –Ω–∞ —Å–º—ã—Å–ª–æ–≤—ã–µ —á–∞–Ω–∫–∏
- –°–æ–∑–¥–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
- –í—ã–ø–æ–ª–Ω—è–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
- –ö—ç—à–∏—Ä—É–µ—Ç –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã

#### 4. **Enhanced LLM (enhanced_llm.py)**
- –§–æ—Ä–º–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è AI –º–æ–¥–µ–ª–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã

---

## ‚öôÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

### –ü–æ—à–∞–≥–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º:

```mermaid
graph TD
    A[üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ] --> B[ü§ñ bot.py –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ]
    B --> C[üß† nlp_processor –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç]
    
    C --> D[üéØ –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏–µ]
    C --> E[üè∑Ô∏è –ò–∑–≤–ª–µ–∫–∞–µ—Ç –ø—Ä–æ–¥—É–∫—Ç—ã]
    C --> F[üòä –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å]
    C --> G[üìö –†–∞—Å—à–∏—Ä—è–µ—Ç —Å–∏–Ω–æ–Ω–∏–º–∞–º–∏]
    
    H[üíæ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—ç—à] --> I{–ï—Å—Ç—å –≤ –∫—ç—à–µ?}
    I -->|–î–∞| J[‚ö° –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç]
    I -->|–ù–µ—Ç| K[üóÉÔ∏è –ü–æ–∏—Å–∫ –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î]
    
    K --> L[üìä –ü–æ–∏—Å–∫ –ø–æ —á–∞–Ω–∫–∞–º —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏]
    L --> M[ü§ñ enhanced_llm –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç]
    M --> N[üíæ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –∫—ç—à]
    N --> O[üì± –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é]
    
    F --> P{–ù–µ–≥–∞—Ç–∏–≤–Ω–∞—è —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å?}
    P -->|–î–∞| Q[üö® –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞]
```

### –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:

#### –≠—Ç–∞–ø 1: –ê–Ω–∞–ª–∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è
```python
# –ü—Ä–∏–º–µ—Ä: "–ß—Ç–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø—Ä–∏ –ø—Ä–æ—Å—Ç—É–¥–µ?"
processed_message = nlp_processor.process_message(text)

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# - intent: –ø–æ–¥–±–æ—Ä_–ø–æ_–ø—Ä–æ–±–ª–µ–º–µ
# - entities: [] (–Ω–µ—Ç –ø—Ä–æ–¥—É–∫—Ç–æ–≤)
# - sentiment: neutral
# - expanded_query: "–ø—Ä–æ—Å—Ç—É–¥–∞ –û–†–í–ò –≥—Ä–∏–ø–ø –Ω–∞—Å–º–æ—Ä–∫ –∫–∞—à–µ–ª—å..."
```

#### –≠—Ç–∞–ø 2: –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–∏—Å–∫–∞
```python
# –î–ª—è –Ω–∞–º–µ—Ä–µ–Ω–∏—è "–ø–æ–¥–±–æ—Ä_–ø–æ_–ø—Ä–æ–±–ª–µ–º–µ" - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫
if intent == "–ø–æ–¥–±–æ—Ä_–ø–æ_–ø—Ä–æ–±–ª–µ–º–µ":
    search_results = enhanced_vector_db.search_by_use_case(expanded_query)
    
# –î–ª—è "–≤–æ–ø—Ä–æ—Å_–æ_—Å–æ—Å—Ç–∞–≤–µ" - –ø–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –≤ —á–∞–Ω–∫–∞—Ö —Å–æ—Å—Ç–∞–≤–∞
elif intent == "–≤–æ–ø—Ä–æ—Å_–æ_—Å–æ—Å—Ç–∞–≤–µ":
    search_results = enhanced_vector_db.search(query, filters={"chunk_type": "composition"})
```

#### –≠—Ç–∞–ø 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
```python
# LLM –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏—è
system_prompt = get_system_prompt_for_intent(intent)
context = build_context_from_search_results(search_results)
answer = llm.generate_response(question, context, system_prompt)
```

---

## üìö –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞ knowledge_base.json

```json
[
  {
    "id": "solberry_h",                    // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø—Ä–æ–¥—É–∫—Ç–∞
    "product": "–°–æ–ª–±–µ—Ä—Ä–∏-H (Solberry-H)",  // –ü–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
    "category": "–ê–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç—ã",           // –ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
    "form": "90 –∫–∞–ø—Å—É–ª, –º–∞—Å—Å–æ–π 450 –º–≥",    // –§–æ—Ä–º–∞ –≤—ã–ø—É—Å–∫–∞
    "description": "–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞...", // –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
    "benefits": [                          // –ü–æ–∫–∞–∑–∞–Ω–∏—è (–º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫)
      "–ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –ø—Ä–æ—Å—Ç—É–¥–∞—Ö, –≥—Ä–∏–ø–ø–µ, –∞–Ω–≥–∏–Ω–∞—Ö",
      "–ø—Ä–∏ —É–º—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö",
      "–ø—Ä–∏ –≥–∏–ø–æ–≤–∏—Ç–∞–º–∏–Ω–æ–∑–∞—Ö"
    ],
    "composition": "—Å–æ—Å—Ç–∞–≤ –ø—Ä–æ–¥—É–∫—Ç–∞...",   // –°–æ—Å—Ç–∞–≤
    "dosage": "–ø–æ 1-2 –∫–∞–ø—Å—É–ª–µ –≤ –¥–µ–Ω—å...", // –°–ø–æ—Å–æ–± –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
    "duration": "30 –¥–Ω–µ–π",                // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫—É—Ä—Å–∞
    "contraindications": "–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –Ω–µ–ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å...",
    "nutrition_per_100g": "–±–µ–ª–∫–∏ ‚Äì 8,5 –≥...", // –ü–∏—â–µ–≤–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å
    "energy": "410,8 –∫–∫–∞–ª/1718,8 –∫–î–∂",    // –≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å
    "storage": "–ø—Ä–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –æ—Ç 0¬∫–° –¥–æ +25¬∫–°...", // –•—Ä–∞–Ω–µ–Ω–∏–µ
    "shelf_life": "2 –≥–æ–¥–∞",               // –°—Ä–æ–∫ –≥–æ–¥–Ω–æ—Å—Ç–∏
    "special_note": "–î–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ..." // –û—Å–æ–±—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è
  }
]
```

### –ö–∞–∫ –±–æ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –±–∞–∑—É –∑–Ω–∞–Ω–∏–π

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —á–∞–Ω–∫–∏:
```python
# –ö–∞–∂–¥—ã–π –ø—Ä–æ–¥—É–∫—Ç —Å–æ–∑–¥–∞–µ—Ç 5 —Ç–∏–ø–æ–≤ —á–∞–Ω–∫–æ–≤:

1. "description" - –æ–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
   –¢–µ–∫—Å—Ç: "–û–∑–¥–æ—Ä–∞–≤–ª–∏–≤–∞—é—â–∏–π –Ω–∞–ø–∏—Ç–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—É—Ö–æ–≥–æ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–æ–∫–∞ –æ–±–ª–µ–ø–∏—Ö–∏..."

2. "benefits" - –ø–æ–∫–∞–∑–∞–Ω–∏—è –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é
   –¢–µ–∫—Å—Ç: "–ü–æ–∫–∞–∑–∞–Ω–∏—è –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é: –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –ø—Ä–æ—Å—Ç—É–¥–∞—Ö, –≥—Ä–∏–ø–ø–µ, –∞–Ω–≥–∏–Ω–∞—Ö; –ø—Ä–∏ —É–º—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö..."

3. "composition" - —Å–æ—Å—Ç–∞–≤
   –¢–µ–∫—Å—Ç: "–°–æ—Å—Ç–∞–≤: c–æ–∫ –æ–±–ª–µ–ø–∏—Ö–∏ —Å—É—Ö–æ–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, –º–∞–ª—å—Ç–æ–¥–µ–∫—Å—Ç—Ä–∏–Ω..."

4. "dosage" - —Å–ø–æ—Å–æ–± –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
   –¢–µ–∫—Å—Ç: "–°–ø–æ—Å–æ–± –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è: –ø–æ 1-2 –∫–∞–ø—Å—É–ª–µ –≤ –¥–µ–Ω—å –≤–æ –≤—Ä–µ–º—è –µ–¥—ã, –∫—É—Ä—Å 30 –¥–Ω–µ–π"

5. "contraindications" - –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è
   –¢–µ–∫—Å—Ç: "–ü—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è: –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –Ω–µ–ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø—Ä–æ–¥—É–∫—Ç–∞"
```

#### –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞–Ω–∫–∞:
```python
metadata = {
    "category": "–ê–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç—ã",
    "use_cases": ["–ø—Ä–æ—Å—Ç—É–¥–∞", "—É—Å—Ç–∞–ª–æ—Å—Ç—å", "–∏–º–º—É–Ω–∏—Ç–µ—Ç"],
    "for_whom": ["–≤–∑—Ä–æ—Å–ª—ã–µ"],
    "product_id": "solberry_h",
    "source": "knowledge_base.json"
}
```

### –ü—Ä–∞–≤–∏–ª–∞ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π

#### ‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:**
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–ª–∞—Ç–∏–Ω–∏—Ü–µ–π, –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤)
- `product` - –ø–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞
- `category` - –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞
- `description` - –æ–ø–∏—Å–∞–Ω–∏–µ (–º–∏–Ω–∏–º—É–º 100 —Å–∏–º–≤–æ–ª–æ–≤)
- `benefits` - –º–∞—Å—Å–∏–≤ –ø–æ–∫–∞–∑–∞–Ω–∏–π (–º–∏–Ω–∏–º—É–º 3 –ø—É–Ω–∫—Ç–∞)
- `composition` - —Å–æ—Å—Ç–∞–≤ –ø—Ä–æ–¥—É–∫—Ç–∞
- `dosage` - —Å–ø–æ—Å–æ–± –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
- `contraindications` - –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è

#### ‚ö†Ô∏è **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–æ–ª—è:**
- `duration` - –∫—É—Ä—Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
- `form` - —Ñ–æ—Ä–º–∞ –≤—ã–ø—É—Å–∫–∞
- `storage` - —É—Å–ª–æ–≤–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
- `special_note` - –≤–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

#### üö´ **–ß–µ–≥–æ –∏–∑–±–µ–≥–∞—Ç—å:**
```json
// ‚ùå –ü–ª–æ—Ö–æ:
"benefits": ["—Ö–æ—Ä–æ—à–æ –ø–æ–º–æ–≥–∞–µ—Ç", "–ø–æ–ª–µ–∑–Ω–æ", "—Ä–µ–∫–æ–º–µ–Ω–¥—É—é"]

// ‚úÖ –•–æ—Ä–æ—à–æ:
"benefits": [
  "–ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –ø—Ä–æ—Å—Ç—É–¥–∞—Ö –∏ –û–†–í–ò",
  "–¥–ª—è —É–∫—Ä–µ–ø–ª–µ–Ω–∏—è –∏–º–º—É–Ω–∏—Ç–µ—Ç–∞",
  "–ø—Ä–∏ –ø–æ–≤—ã—à–µ–Ω–Ω—ã—Ö —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö"
]
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞

#### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
```json
{
  "id": "new_product_2024",              // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
  "product": "–ù–æ–≤—ã–π –ü—Ä–æ–¥—É–∫—Ç 2024",       // –ù–∞–∑–≤–∞–Ω–∏–µ
  "category": "–í–∏—Ç–∞–º–∏–Ω—ã",                // –ö–∞—Ç–µ–≥–æ—Ä–∏—è
  "description": "–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞, –µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏...",
  "benefits": [
    "–ø—Ä–∏ –∞–≤–∏—Ç–∞–º–∏–Ω–æ–∑–µ –∏ –≥–∏–ø–æ–≤–∏—Ç–∞–º–∏–Ω–æ–∑–µ",
    "–¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏",
    "–ø—Ä–∏ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–ª–æ—Å—Ç–∏"
  ],
  "composition": "–≤–∏—Ç–∞–º–∏–Ω C 100–º–≥, –≤–∏—Ç–∞–º–∏–Ω D3 400–ú–ï, —Ü–∏–Ω–∫ 15–º–≥...",
  "dosage": "–ø–æ 1 –∫–∞–ø—Å—É–ª–µ 2 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å –≤–æ –≤—Ä–µ–º—è –µ–¥—ã",
  "duration": "30 –¥–Ω–µ–π",
  "contraindications": "–±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å, –ª–∞–∫—Ç–∞—Ü–∏—è, –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –Ω–µ–ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å"
}
```

#### –®–∞–≥ 2: –î–æ–±–∞–≤—å—Ç–µ –≤ knowledge_base.json
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `knowledge_base.json`
2. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –≤ –º–∞—Å—Å–∏–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª –≤ –∫–æ–¥–∏—Ä–æ–≤–∫–µ UTF-8

#### –®–∞–≥ 3: –î–æ–∂–¥–∏—Ç–µ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
```
# –í –ª–æ–≥–∞—Ö –ø–æ—è–≤–∏—Ç—Å—è:
üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ knowledge_base.json ‚Äî –æ–±–Ω–æ–≤–ª—è–µ–º –±–∞–∑—É...
‚úÖ –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω–∞: 15 —á–∞–Ω–∫–æ–≤ –∏–∑ 3 –ø—Ä–æ–¥—É–∫—Ç–æ–≤
```

#### –®–∞–≥ 4: –î–æ–±–∞–≤—å—Ç–µ —Å–∏–Ω–æ–Ω–∏–º—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–ï—Å–ª–∏ —É –ø—Ä–æ–¥—É–∫—Ç–∞ –µ—Å—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è, –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ `nlp_processor.py`:

```python
# –í –º–µ—Ç–æ–¥–µ _load_products() –¥–æ–±–∞–≤—å—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:
if "–ù–æ–≤—ã–π –ü—Ä–æ–¥—É–∫—Ç" in item["product"]:
    products.extend(["–ù–ü-2024", "–Ω–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç", "–Ω–æ–≤–∏–Ω–∫–∞ 2024"])
```

---

## üß† –ù–∞—Å—Ç—Ä–æ–π–∫–∞ NLP –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏—è–º–∏

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –Ω–∞–º–µ—Ä–µ–Ω–∏—è:

1. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–µ** –≤ `nlp_processor.py`:
```python
class Intent(Enum):
    # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ...
    SIDE_EFFECTS = "–≤–æ–ø—Ä–æ—Å_–æ_–ø–æ–±–æ—á–Ω—ã—Ö_—ç—Ñ—Ñ–µ–∫—Ç–∞—Ö"  # –ù–æ–≤–æ–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–µ
```

2. **–î–æ–±–∞–≤—å—Ç–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è**:
```python
self.intent_patterns = {
    # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ...
    Intent.SIDE_EFFECTS: [
        r"–ø–æ–±–æ—á–Ω—ã–µ.*—ç—Ñ—Ñ–µ–∫—Ç—ã",
        r"–µ—Å—Ç—å.*–ª–∏.*–≤—Ä–µ–¥",
        r"–∫–∞–∫–∏–µ.*–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è",
        r"–±–µ–∑–æ–ø–∞—Å–Ω–æ.*–ª–∏.*–ø—Ä–∏–Ω–∏–º–∞—Ç—å",
        r"–º–æ–≥—É—Ç.*–ª–∏.*–±—ã—Ç—å.*–ø—Ä–æ–±–ª–µ–º—ã"
    ]
}
```

3. **–°–æ–∑–¥–∞–π—Ç–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–æ–º–ø—Ç** –≤ `enhanced_llm.py`:
```python
self.system_prompts = {
    # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ...
    Intent.SIDE_EFFECTS: """
–¢—ã - –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –ø–æ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –∫–æ–º–ø–∞–Ω–∏–∏ –ê–≤—Ä–æ—Ä–∞. –û—Ç–≤–µ—á–∞–π –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–∞—Ö –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

–ü—Ä–∞–≤–∏–ª–∞:
1. –í—Å–µ–≥–¥–∞ —É–ø–æ–º–∏–Ω–∞–π –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π
2. –†–µ–∫–æ–º–µ–Ω–¥—É–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –≤—Ä–∞—á–∞ –ø—Ä–∏ —Å–æ–º–Ω–µ–Ω–∏—è—Ö
3. –ë—É–¥—å —á–µ—Å—Ç–Ω–æ–π –æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ä–∏—Å–∫–∞—Ö
4. –£–∫–∞–∑—ã–≤–∞–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
"""
}
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏–Ω–æ–Ω–∏–º–∞–º–∏

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ª–æ–≤–∞—Ä—è —Å–∏–Ω–æ–Ω–∏–º–æ–≤:
```python
self.synonyms = {
    "–æ—Å–Ω–æ–≤–Ω–æ–µ_—Å–ª–æ–≤–æ": ["—Å–∏–Ω–æ–Ω–∏–º1", "—Å–∏–Ω–æ–Ω–∏–º2", "—Å–∏–Ω–æ–Ω–∏–º3"],
    
    # –ü—Ä–∏–º–µ—Ä—ã:
    "–ø—Ä–æ—Å—Ç—É–¥–∞": ["–û–†–í–ò", "–≥—Ä–∏–ø–ø", "–Ω–∞—Å–º–æ—Ä–∫", "–∫–∞—à–µ–ª—å", "—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"],
    "—É—Å—Ç–∞–ª–æ—Å—Ç—å": ["–Ω–µ—Ç —Å–∏–ª", "–≤—è–ª–æ—Å—Ç—å", "–∞–ø–∞—Ç–∏—è", "–ø–µ—Ä–µ—É—Ç–æ–º–ª–µ–Ω–∏–µ"],
    "–ø–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ": ["–ñ–ö–¢", "–∂–µ–ª—É–¥–æ–∫", "–∫–∏—à–µ—á–Ω–∏–∫", "–ø–µ—Ä–µ–≤–∞—Ä–∏–≤–∞–Ω–∏–µ"]
}
```

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –≥—Ä—É–ø–ø—ã —Å–∏–Ω–æ–Ω–∏–º–æ–≤:
```python
# –ü—Ä–∏–º–µ—Ä: –¥–æ–±–∞–≤–ª—è–µ–º —Å–∏–Ω–æ–Ω–∏–º—ã –¥–ª—è "–ø–∞–º—è—Ç—å"
"–ø–∞–º—è—Ç—å": [
    "–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è", "–≤–Ω–∏–º–∞–Ω–∏–µ", "–∑–∞–±—ã–≤—á–∏–≤–æ—Å—Ç—å", 
    "—Ä–∞—Å—Å–µ—è–Ω–Ω–æ—Å—Ç—å", "–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è", "–∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏"
]
```

#### –ü—Ä–∞–≤–∏–ª–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–∏–Ω–æ–Ω–∏–º–æ–≤:
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
- ‚úÖ –ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –ø–æ —Å–º—ã—Å–ª—É, –∞ –Ω–µ –ø–æ –∑–≤—É—á–∞–Ω–∏—é
- ‚úÖ –í–∫–ª—é—á–∞–π—Ç–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã –∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
- ‚ùå –ù–µ –¥—É–±–ª–∏—Ä—É–π—Ç–µ —Å–∏–Ω–æ–Ω–∏–º—ã –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ:
–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏–∑ `knowledge_base.json`.

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π:
```python
# –í –º–µ—Ç–æ–¥–µ _load_products() –≤ nlp_processor.py:
def _load_products(self) -> List[str]:
    # ... –∫–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏ ...
    for item in data:
        products.append(item["product"])  # –û—Å–Ω–æ–≤–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤:
        if "–°–æ–ª–±–µ—Ä—Ä–∏" in item["product"]:
            products.extend([
                "–°–æ–ª–±–µ—Ä—Ä–∏", "Solberry", "—Å–æ–ª–±–µ—Ä—Ä–∏-h", 
                "—Å–æ–ª–±–µ—Ä—Ä–∏ h", "–æ–±–ª–µ–ø–∏—Ö–∞ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç"
            ])
        
        if "–ë–∏—Ç–µ—Ä–æ–Ω" in item["product"]:
            products.extend([
                "–ë–∏—Ç–µ—Ä–æ–Ω", "Beeteron", "–±–∏—Ç–µ—Ä–æ–Ω-h",
                "–±–∏—Ç–µ—Ä–æ–Ω h", "—Å–≤–µ–∫–ª–∞ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç"
            ])
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

#### 1. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–π** (–≤ –ª–æ–≥–∞—Ö):
```
log_user_action(user_id, "Intent: –ø–æ–¥–±–æ—Ä_–ø–æ_–ø—Ä–æ–±–ª–µ–º–µ, Sentiment: neutral")
```

**–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ:**
- –ö–∞–∫–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏—è –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —á–∞—â–µ –≤—Å–µ–≥–æ?
- –ú–Ω–æ–≥–æ –ª–∏ –Ω–µ–æ–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö –Ω–∞–º–µ—Ä–µ–Ω–∏–π (`–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ`)?

#### 2. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫—ç—à–∞**:
```
# –í –æ—Ç–≤–µ—Ç–∞—Ö –∏—â–∏—Ç–µ:
"üí° _–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ –∫—ç—à–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ—Ç–≤–µ—Ç–∞_"
```

**–¶–µ–ª—å:** 60-70% –æ—Ç–≤–µ—Ç–æ–≤ –¥–æ–ª–∂–Ω—ã –±—Ä–∞—Ç—å—Å—è –∏–∑ –∫—ç—à–∞.

#### 3. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è**:
```
üö® –ü–†–ò–û–†–ò–¢–ï–¢ - –ñ–∞–ª–æ–±–∞ –æ—Ç @username (ID: 12345)
```

**–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ:**
- –ß–∞—Å—Ç–æ—Ç—É –∂–∞–ª–æ–± –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø—Ä–æ–¥—É–∫—Ç–∞–º
- –î–∏–Ω–∞–º–∏–∫—É –Ω–µ–¥–æ–≤–æ–ª—å—Å—Ç–≤–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ NLP:
```bash
python -c "
from nlp_processor import nlp_processor
result = nlp_processor.process_message('–ß—Ç–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø—Ä–∏ –ø—Ä–æ—Å—Ç—É–¥–µ?')
print(f'Intent: {result.intent.value}')
print(f'Expanded: {result.expanded_query}')
"
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑—ã:
```bash
python -c "
from enhanced_vector_db import enhanced_vector_db
enhanced_vector_db.index_knowledge()
results = enhanced_vector_db.search('–ø—Ä–æ—Å—Ç—É–¥–∞', limit=2)
print(f'Found {len(results)} results')
for r in results:
    print(f'- {r.chunk.product}: {r.score:.3f}')
"
```

#### –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
python test_enhanced_features.py
```

### –õ–æ–≥–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

#### –í–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –≤ –ª–æ–≥–∞—Ö:
```bash
# –£—Å–ø–µ—à–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:
‚úÖ –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω–∞: X —á–∞–Ω–∫–æ–≤ –∏–∑ Y –ø—Ä–æ–¥—É–∫—Ç–æ–≤
üîÑ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î –∑–∞–ø—É—â–µ–Ω–æ

# –û—à–∏–±–∫–∏:
‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î: ...
‚ùå Enhanced AI –æ—à–∏–±–∫–∞: ...

# –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
Intent: –ø–æ–¥–±–æ—Ä_–ø–æ_–ø—Ä–æ–±–ª–µ–º–µ, Sentiment: neutral, Entities: PRODUCT: –°–æ–ª–±–µ—Ä—Ä–∏-H
üö® –ü–†–ò–û–†–ò–¢–ï–¢ - –ñ–∞–ª–æ–±–∞ –æ—Ç @username
```

---

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ë–æ—Ç –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –Ω–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç

#### –°–∏–º–ø—Ç–æ–º—ã:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ –ø—Ä–æ–¥—É–∫—Ç–µ, –Ω–æ –±–æ—Ç –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- –í –ª–æ–≥–∞—Ö –Ω–µ—Ç `Entities: PRODUCT: –Ω–∞–∑–≤–∞–Ω–∏–µ_–ø—Ä–æ–¥—É–∫—Ç–∞`

#### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:
```bash
python -c "
from nlp_processor import nlp_processor
result = nlp_processor.process_message('–†–∞—Å—Å–∫–∞–∂–∏ –ø—Ä–æ –ù–æ–≤—ã–π –ü—Ä–æ–¥—É–∫—Ç')
print('Entities:', [(e.label, e.text) for e in result.entities])
"
```

#### –†–µ—à–µ–Ω–∏—è:
1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ knowledge_base.json:**
   - –ü—Ä–æ–¥—É–∫—Ç –¥–æ–±–∞–≤–ª–µ–Ω?
   - –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ UTF-8?
   - –ù–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ JSON?

2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
   ```bash
   # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: Ctrl+C
   python bot.py
   ```

3. **–î–æ–±–∞–≤—å—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è:**
   ```python
   # –í nlp_processor.py, –º–µ—Ç–æ–¥ _load_products()
   if "–ù–æ–≤—ã–π –ü—Ä–æ–¥—É–∫—Ç" in item["product"]:
       products.extend(["–ù–ü", "–Ω–æ–≤–∏–Ω–∫–∞", "–Ω–æ–≤—ã–π"])
   ```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–º–µ—Ä–µ–Ω–∏—è

#### –°–∏–º–ø—Ç–æ–º—ã:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ —Å–æ—Å—Ç–∞–≤–µ, –Ω–æ –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏
- –í –ª–æ–≥–∞—Ö `Intent: –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ` –¥–ª—è –æ—á–µ–≤–∏–¥–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤

#### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:
```bash
python -c "
from nlp_processor import nlp_processor
result = nlp_processor.process_message('–ö–∞–∫–æ–π —Å–æ—Å—Ç–∞–≤ —É –°–æ–ª–±–µ—Ä—Ä–∏?')
print('Intent:', result.intent.value)
print('Confidence:', result.confidence)
"
```

#### –†–µ—à–µ–Ω–∏—è:
1. **–î–æ–±–∞–≤—å—Ç–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ nlp_processor.py:**
   ```python
   Intent.COMPOSITION_INQUIRY: [
       r"—Å–æ—Å—Ç–∞–≤.*–ø—Ä–æ–¥—É–∫—Ç–∞",
       r"—á—Ç–æ.*–≤—Ö–æ–¥–∏—Ç.*–≤.*—Å–æ—Å—Ç–∞–≤",
       r"–∏–∑.*—á–µ–≥–æ.*—Å–æ—Å—Ç–æ–∏—Ç",
       r"–∫–∞–∫–∏–µ.*–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã",
       r"–∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã",
       # –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:
       r"—á—Ç–æ.*—Å–æ–¥–µ—Ä–∂–∏—Ç",
       r"–∫–∞–∫–∏–µ.*–≤–µ—â–µ—Å—Ç–≤–∞"
   ]
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—è–¥–æ–∫ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤** - –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã—à–µ.

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã

#### –°–∏–º–ø—Ç–æ–º—ã:
- –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –¥–æ–ª—å—à–µ 5-10 —Å–µ–∫—É–Ω–¥
- –ú–∞–ª–æ –æ—Ç–≤–µ—Ç–æ–≤ –∏–∑ –∫—ç—à–∞

#### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:
1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π:**
   ```bash
   python -c "
   import json
   with open('knowledge_base.json', 'r', encoding='utf-8') as f:
       data = json.load(f)
   print(f'–ü—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –±–∞–∑–µ: {len(data)}')
   "
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```bash
   # –ó–∞–¥–∞–π—Ç–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å –¥–≤–∞–∂–¥—ã
   # –í—Ç–æ—Ä–æ–π —Ä–∞–∑ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–≤–µ—Ç "–∏–∑ –∫—ç—à–∞"
   ```

#### –†–µ—à–µ–Ω–∏—è:
1. **–£–≤–µ–ª–∏—á—å—Ç–µ —Ä–∞–∑–º–µ—Ä –∫—ç—à–∞:**
   ```python
   # –í enhanced_vector_db.py:
   self.response_cache = ResponseCache(max_size=200)  # –ë—ã–ª–æ 100
   ```

2. **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –ø–æ–∏—Å–∫:**
   ```python
   # –í enhanced_llm.py, —É–º–µ–Ω—å—à–∏—Ç–µ limit:
   search_results = enhanced_vector_db.search(query, limit=2)  # –ë—ã–ª–æ 3
   ```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ù–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å–∏–Ω–æ–Ω–∏–º—ã

#### –°–∏–º–ø—Ç–æ–º—ã:
- "–û–†–í–ò" –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Å—Ç—É–¥–µ
- –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–æ—á–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤

#### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:
```bash
python -c "
from nlp_processor import nlp_processor
result = nlp_processor.process_message('–£ –º–µ–Ω—è –û–†–í–ò')
print('Normalized:', result.normalized_text)
print('Expanded:', result.expanded_query)
"
```

#### –†–µ—à–µ–Ω–∏—è:
1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Å–∏–Ω–æ–Ω–∏–º–æ–≤:**
   ```python
   # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
   self.synonyms = {
       '–ø—Ä–æ—Å—Ç—É–¥–∞': ['–æ—Ä–≤–∏', '–≥—Ä–∏–ø–ø']  # –ù–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
   }
   
   # ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:
   self.synonyms = {
       '–ü—Ä–æ—Å—Ç—É–¥–∞': ['–û–†–í–ò', '–ì—Ä–∏–ø–ø']  # –†–∞–∑–Ω—ã–π —Ä–µ–≥–∏—Å—Ç—Ä
   }
   ```

2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞** –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏–Ω–æ–Ω–∏–º–æ–≤.

### –ü—Ä–æ–±–ª–µ–º–∞ 5: OpenAI API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

#### –°–∏–º–ø—Ç–æ–º—ã:
- –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –±–∞–∑–æ–≤—ã–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏ –≤–º–µ—Å—Ç–æ AI –æ—Ç–≤–µ—Ç–æ–≤
- –í –ª–æ–≥–∞—Ö: "‚ùå –û—à–∏–±–∫–∞ OpenAI API: 401/429/500"

#### –†–µ—à–µ–Ω–∏—è:
1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á –≤ .env:**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ:
   OPENAI_API_KEY=sk-...
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–≤–æ—Ç—ã OpenAI:**
   - –í–æ–π–¥–∏—Ç–µ –≤ https://platform.openai.com/usage
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞

3. **–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
   - –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ fallback —Ä–µ–∂–∏–º
   - –û—Ç–≤–µ—Ç—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

---

## üìà –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

#### –î–ª—è –Ω–µ–±–æ–ª—å—à–æ–π –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π (–¥–æ 10 –ø—Ä–æ–¥—É–∫—Ç–æ–≤):
```python
# enhanced_vector_db.py:
ResponseCache(max_size=100)

# enhanced_llm.py:
search_results = enhanced_vector_db.search(query, limit=3)
```

#### –î–ª—è –±–æ–ª—å—à–æ–π –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π (–±–æ–ª–µ–µ 20 –ø—Ä–æ–¥—É–∫—Ç–æ–≤):
```python
# enhanced_vector_db.py:
ResponseCache(max_size=300)

# enhanced_llm.py:
search_results = enhanced_vector_db.search(query, limit=5)
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤

#### –ü–∞–º—è—Ç—å:
- –ö—ç—à: ~1MB –Ω–∞ 100 –æ—Ç–≤–µ—Ç–æ–≤
- –í–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞: ~100KB –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç
- –ú–æ–¥–µ–ª—å: ~500MB (sentence-transformers)

#### –°–µ—Ç—å:
- OpenAI API: ~2KB –Ω–∞ –∑–∞–ø—Ä–æ—Å
- Qdrant: ~1KB –Ω–∞ –ø–æ–∏—Å–∫

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —è–∑—ã–∫–æ–≤

1. **–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–µ–≤–æ–¥—ã —Å–∏–Ω–æ–Ω–∏–º–æ–≤:**
   ```python
   self.synonyms_en = {
       "cold": ["flu", "cough", "fever", "runny nose"],
       "fatigue": ["tiredness", "weakness", "exhaustion"]
   }
   ```

2. **–î–æ–±–∞–≤—å—Ç–µ —è–∑—ã–∫–æ–≤—É—é –¥–µ—Ç–µ–∫—Ü–∏—é:**
   ```python
   def detect_language(self, text):
       # –ü—Ä–æ—Å—Ç–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞
       if any(ord(char) > 127 for char in text):
           return "ru"
       return "en"
   ```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤

–ë–æ—Ç –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å:
- WhatsApp (—á–µ—Ä–µ–∑ WhatsApp Business API)
- Viber (—á–µ—Ä–µ–∑ Viber Bot API)
- Web-—á–∞—Ç (—á–µ—Ä–µ–∑ WebSocket)

–û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ `enhanced_llm.py`, –º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã

### –ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ª–æ–≥–∏** —Å –æ—à–∏–±–∫–∞–º–∏
2. **–û–ø–∏—à–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. **–£–∫–∞–∂–∏—Ç–µ –≤—Ä–µ–º—è** –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã
4. **–ü—Ä–∏–ª–æ–∂–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã** –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
python test_enhanced_features.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π:
python -c "from enhanced_vector_db import enhanced_vector_db; enhanced_vector_db.index_knowledge()"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ NLP:
python -c "from nlp_processor import nlp_processor; print(nlp_processor.process_message('—Ç–µ—Å—Ç'))"

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (Linux/Mac):
tail -f bot.log

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç–æ–≥–æ –º–µ—Å—Ç–∞:
du -sh *
```

---

**–ü–æ–º–Ω–∏—Ç–µ:** –ë–æ—Ç —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ —Å–∞–º–æ–æ–±—É—á–∞—é—â–∞—è—Å—è —Å–∏—Å—Ç–µ–º–∞. –ß–µ–º –±–æ–ª—å—à–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤—ã –¥–æ–±–∞–≤–∏—Ç–µ –≤ –±–∞–∑—É –∑–Ω–∞–Ω–∏–π –∏ —á–µ–º —Ç–æ—á–Ω–µ–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç–µ NLP –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Ç–µ–º –ª—É—á—à–µ –æ–Ω –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å! üöÄ

